import React, { useState } from 'react';
import { DoodleButton, DoodleCard } from './DoodleComponents';

interface GeminiCriticProps {
  imageData: string | null;
}

const PHRASES = [
  "–û–≥–æ! –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ —à–µ–¥–µ–≤—Ä! 10/10! üé®",
  "–ö–∞–∫–æ–π –∫–ª–∞—Å—Å–Ω—ã–π —Å—Ç–∏–ª—å! –ú–Ω–µ –æ—á–µ–Ω—å –Ω—Ä–∞–≤–∏—Ç—Å—è! üî•",
  "–≠—Ç–æ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫–∏–º –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–º! üíé",
  "–Ø –±—ã –¥–∞–ª —ç—Ç–æ–º—É –º–∞—Å–∫–æ—Ç—É –ø–µ—Ä–≤–æ–µ –º–µ—Å—Ç–æ! üèÜ",
  "–í–∞—É! –ù–∞—Å—Ç–æ—è—â–∏–π —Ü–∏—Ñ—Ä–æ–≤–æ–π –∞–ª–º–∞–∑! üíé‚ú®",
  "–û—á–µ–Ω—å –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ! –¢—ã –Ω–∞—Å—Ç–æ—è—â–∏–π —Ö—É–¥–æ–∂–Ω–∏–∫! üë®‚Äçüé®",
  "–°—Ä–∞–∑—É –≤–∏–¥–Ω–æ ‚Äî –±—É–¥—É—â–∏–π —Å–∏–º–≤–æ–ª –Ø–∫—É—Ç–∏–∏! ‚ùÑÔ∏è",
  "–ö–∞–∫–∏–µ —è—Ä–∫–∏–µ —Ü–≤–µ—Ç–∞! –ì–ª–∞–∑ –Ω–µ –æ—Ç–æ—Ä–≤–∞—Ç—å! üåà",
  "–≠—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –æ—á–µ–Ω—å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–Ω–æ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ! ü§ñ",
  "–ü—Ä–æ—Å—Ç–æ –∫–æ—Å–º–æ—Å! üöÄ",
  "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —ç—Ç–∞ —É–≤–µ—Ä–µ–Ω–Ω–∞—è –ø–æ–∑–∞! üòé",
  "11 –∏–∑ 10! –ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ! ü§Ø",
  "–≠—Ç–æ—Ç —Ä–∏—Å—É–Ω–æ–∫ –∑–∞—Ä—è–∂–µ–Ω –Ω–∞ –ø–æ–±–µ–¥—É! ‚ö°",
  "–ö–∞–∫–∞—è –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –¥–µ—Ç–∞–ª—å! –°—É–ø–µ—Ä! üîç",
  "–Ø –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ! –•–æ—á—É —Ñ—É—Ç–±–æ–ª–∫—É —Å —ç—Ç–∏–º –ø—Ä–∏–Ω—Ç–æ–º! üëï",
  "–û—á–µ–Ω—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ! –ù–∏–≥–¥–µ —Ç–∞–∫–æ–≥–æ –Ω–µ –≤–∏–¥–µ–ª! ü¶Ñ",
  "–≠—Ç–æ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂ —Ç–æ—á–Ω–æ –ø—Ä–∏–Ω–µ—Å–µ—Ç —É–¥–∞—á—É! üçÄ",
  "–í—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –≥–µ—Ä–æ–π –∫—Ä—É—Ç–æ–π –≤–∏–¥–µ–æ–∏–≥—Ä—ã! üéÆ",
  "–°—É–ø–µ—Ä! –û—Ç–ø—Ä–∞–≤–ª—è–π —Å–∫–æ—Ä–µ–µ –Ω–∞ –∫–æ–Ω–∫—É—Ä—Å! üì©",
  "–ú–Ω–µ –∫–∞–∂–µ—Ç—Å—è, –∂—é—Ä–∏ –±—É–¥–µ—Ç –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ! üòç",
  "–¢–≤–æ–π —Å—Ç–∏–ª—å —Ä–∏—Å–æ–≤–∞–Ω–∏—è —É–Ω–∏–∫–∞–ª–µ–Ω! –ü—Ä–æ–¥–æ–ª–∂–∞–π! ‚úçÔ∏è",
  "–≠—Ç–æ –ª—É—á—à–µ–µ, —á—Ç–æ —è –≤–∏–¥–µ–ª –∑–∞ —Å–µ–≥–æ–¥–Ω—è! üåü",
  "–ö–∞–∫–æ–π –º–∏–ª—ã–π –∏ –≤ —Ç–æ –∂–µ –≤—Ä–µ–º—è —Å–µ—Ä—å–µ–∑–Ω—ã–π –ø–µ—Ä—Å–æ–Ω–∞–∂! üßê",
  "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ —Ç—Ä–∞–¥–∏—Ü–∏–∏ –≤ –æ–¥–Ω–æ–º —Ä–∏—Å—É–Ω–∫–µ! –ë—Ä–∞–≤–æ! üëè",
  "–Ø —Å–æ—Ö—Ä–∞–Ω–∏–ª —ç—Ç–æ—Ç —Ä–∏—Å—É–Ω–æ–∫ —Å–µ–±–µ –≤ –ø–∞–º—è—Ç—å! üíæ",
  "–í—ã–≥–ª—è–¥–∏—Ç –æ—á–µ–Ω—å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ! üíº",
  "–≠—Ç–æ—Ç –º–∞—Å–∫–æ—Ç –ø—Ä–æ—Å—Ç–æ —Å–≤–µ—Ç–∏—Ç—Å—è —ç–Ω–µ—Ä–≥–∏–µ–π! üí°",
  "–ê–ª–º–∞–∑–Ω–∞—è —Ä–∞–±–æ—Ç–∞! üíé‚õèÔ∏è",
  "–û—Ç–ª–∏—á–Ω–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è! üìê",
  "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è, –∫–∞–∫ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –ª–∏–Ω–∏–∏! „Ä∞Ô∏è",
  "–≠—Ç–æ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂ –≥–æ—Ç–æ–≤ –∫ —Ü–∏—Ñ—Ä–æ–≤–æ–º—É –±—É–¥—É—â–µ–º—É! üåê",
  "–Ø –≤–∏–∂—É –≤ —ç—Ç–æ–º —Ä–∏—Å—É–Ω–∫–µ –±–æ–ª—å—à–æ–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª! üìà",
  "–ü—Ä–æ—Å—Ç–æ, –Ω–æ —Å–æ –≤–∫—É—Å–æ–º! –ò–¥–µ–∞–ª—å–Ω–æ! üëå",
  "–≠—Ç–æ—Ç –≤–∑–≥–ª—è–¥... –û–Ω —Å–º–æ—Ç—Ä–∏—Ç –ø—Ä—è–º–æ –≤ –¥—É—à—É! üëÄ",
  "–ö–∞–∂–µ—Ç—Å—è, —è –Ω–∞—à–µ–ª —Å–≤–æ–µ–≥–æ –ª—é–±–∏–º–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞! ‚ù§Ô∏è",
  "–£ —Ç–µ–±—è —Ç–∞–ª–∞–Ω—Ç! –ù–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Å—è! üöÄ",
  "–≠—Ç–æ—Ç —Ä–∏—Å—É–Ω–æ–∫ –≤—ã–∑—ã–≤–∞–µ—Ç —É–ª—ã–±–∫—É! üòä",
  "–û—á–µ–Ω—å –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –æ–±—Ä–∞–∑! ‚òÄÔ∏è",
  "–Ø —É–≤–µ—Ä–µ–Ω, —ç—Ç–æ—Ç –º–∞—Å–∫–æ—Ç —Å—Ç–∞–Ω–µ—Ç –∑–Ω–∞–º–µ–Ω–∏—Ç—ã–º! ‚≠ê",
  "–ö—Ä—É—Ç–æ! –ê –∫–∞–∫ –∑–æ–≤—É—Ç —ç—Ç–æ–≥–æ –≥–µ—Ä–æ—è? ü§î",
  "–≠—Ç–æ –∏–º–µ–Ω–Ω–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ —Ñ–æ—Ä—É–º—É! ‚úÖ",
  "–ó–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Ñ–æ—Ä–º–æ–π! üü£",
  "–í—ã–≥–ª—è–¥–∏—Ç –æ—á–µ–Ω—å –¥–∏–Ω–∞–º–∏—á–Ω–æ! üèÉ‚Äç‚ôÇÔ∏è",
  "–Ø –±—ã –ø–æ—Å—Ç–∞–≤–∏–ª —ç—Ç–æ—Ç —Ä–∏—Å—É–Ω–æ–∫ –Ω–∞ –∑–∞—Å—Ç–∞–≤–∫—É! üì±",
  "–ù–∞—Å—Ç–æ—è—â–µ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ! üñºÔ∏è",
  "–¢—ã –ø—Ä–µ–≤–∑–æ—à–µ–ª —Å–∞–º —Å–µ–±—è! üí™",
  "–≠—Ç–æ—Ç –º–∞—Å–∫–æ—Ç –∏–∑–ª—É—á–∞–µ—Ç –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç! üß†",
  "–û—á–µ–Ω—å —Å—Ç–∏–ª—å–Ω–æ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ! üï∂Ô∏è",
  "–Ø —á—É–≤—Å—Ç–≤—É—é —Å–∏–ª—É —è–∫—É—Ç—Å–∫–∏—Ö –º–æ—Ä–æ–∑–æ–≤ –∏ —Ç–µ–ø–ª–æ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π! ‚ùÑÔ∏èüî•",
  "–ë–µ–∑—É–ø—Ä–µ—á–Ω–æ! üíØ"
];

const NAMES = [
  "–ê–ª–º–∞–∑–∏–∫", "–ö–∏–±–µ—Ä-–Ø–∫—É—Ç", "–î–∏–¥–∂–∏—Ç–∞–ª-–ë—Ä–æ", "–°–µ–≤–µ—Ä", "–ö—Ä–∏—Å—Ç–∞–ª–ª", 
  "–¢–µ—Ö–Ω–æ-–û–ª–µ–Ω—å", "–§—Ä–æ—Å—Ç–±–∞–π—Ç", "–ë–∏—Ç", "–ü–∏–∫—Å–µ–ª—å", "–°–ø–∞—Ä–∫",
  "–ê–π-–¢–∏—à–∞", "–Ø–∫—É—Ç-–ë–æ—Ç", "–°–Ω–æ—É", "–ù–µ–æ", "–ì–ª–∏—Ç—á"
];

export const GeminiCritic: React.FC<GeminiCriticProps> = ({ imageData }) => {
  const [feedback, setFeedback] = useState<string>('');
  const [loading, setLoading] = useState(false);

  const getFeedback = () => {
    if (!imageData) return;

    setLoading(true);
    setFeedback('');

    // Simulate thinking time
    setTimeout(() => {
      const randomPhrase = PHRASES[Math.floor(Math.random() * PHRASES.length)];
      const randomName = NAMES[Math.floor(Math.random() * NAMES.length)];
      
      const response = `
        ü§ñ –ò–º—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞: ${randomName}
        
        ${randomPhrase}
      `;
      
      setFeedback(response);
      setLoading(false);
    }, 1500);
  };

  if (!imageData) return null;

  return (
    <div className="mt-8 max-w-2xl mx-auto w-full px-4">
      <DoodleCard className="bg-purple-50" borderColor="border-purple-600" rotate="-rotate-1">
        <h3 className="text-xl md:text-2xl font-bold text-purple-700 mb-4 hand-font text-center">
          ‚ú® –ú–Ω–µ–Ω–∏–µ –ú–∞–≥–∏—á–µ—Å–∫–æ–≥–æ –ö—Ä–∏—Å—Ç–∞–ª–ª–∞ ‚ú®
        </h3>
        
        {!feedback && !loading && (
          <div className="text-center">
            <p className="mb-4 text-base md:text-lg">–•–æ—á–µ—à—å —É–∑–Ω–∞—Ç—å –º–Ω–µ–Ω–∏–µ –ò–ò –æ —Ç–≤–æ–µ–º —à–µ–¥–µ–≤—Ä–µ?</p>
            <DoodleButton onClick={getFeedback} className="bg-purple-400 hover:bg-purple-300 border-purple-900 w-full md:w-auto">
              –°–ø—Ä–æ—Å–∏—Ç—å –ö—Ä–∏—Å—Ç–∞–ª–ª üîÆ
            </DoodleButton>
          </div>
        )}

        {loading && (
          <div className="text-center py-8">
            <div className="animate-bounce text-4xl mb-2">ü§î</div>
            <p className="text-xl hand-font text-purple-600">–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –ø–∏–∫—Å–µ–ª–∏...</p>
          </div>
        )}

        {feedback && (
          <div className="prose prose-lg max-w-none font-comic text-gray-800 animate-fade-in bg-white p-4 rounded-xl border-2 border-purple-200">
             <div className="whitespace-pre-wrap font-bold text-center">{feedback}</div>
             <div className="mt-4 text-center">
                <button 
                  onClick={getFeedback}
                  className="text-sm text-purple-500 underline hover:text-purple-700"
                >
                  –°–ø—Ä–æ—Å–∏—Ç—å –µ—â–µ —Ä–∞–∑
                </button>
             </div>
          </div>
        )}
      </DoodleCard>
    </div>
  );
};